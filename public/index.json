[{"content":"Few days back, I encountered the following error on my website saral.club.\nbotocore.exceptions.ClientError: An error occurred (SignatureDoesNotMatch) when calling the SendEmail operation: Signature not yet current: 20250505T152002Z is still later than 20250505T151830Z (20250505T151330Z + 5 min.) By the looks of it, the error message is descriptive enough to guide you that there is some kind of time mismatch in the signature. Before sending a request to aws, the botocore library signs the request using your access keys. The signature also includes a timestamp. And the error message is saying that the request I am sending is probably 5 minutes later (in future) then the current time (time on aws servers). Of course, the two clocks (one on my server and the other on aws\u0026rsquo;s server) cannot have the same exact time, so aws allows for some time skew (5 minutes).\nIt makes to sign the request with timestamp, to avoid the reuse of the signature. Imagine if a hacker gets hold of your signature then they can reuse it send the same signature again and again, if there is no timestamp. This is known as \u0026ldquo;replay attacks\u0026rdquo;.\nHow do we fix this? First step is to check the status of your clocks. On your linux machine you can do the following:\n\u0026gt; timedatectl status Local time: Mon 2025-05-05 17:11:21 UTC Universal time: Mon 2025-05-05 17:11:21 UTC RTC time: Mon 2025-05-05 17:04:51 Time zone: Etc/UTC (UTC, +0000) System clock synchronized: no NTP service: active RTC in local TZ: no The command\u0026rsquo;s output shows that the local time is out of sync with RTC time. RTC time refers to the Real Time Clock and it is maintained by the hardware clock. So basically the hardware clock is out of sync with the system clock. The system clock is a software clock maintained by the operating system. It starts when the system boots up and then it is independently maintained by CPU ticks. Overtime the two clocks drift apart. To fix the issue, you can run the following command. This will synchronize the two clocks.\nhwclock --systohc There is one more issue. If you look at the output of timedatectl status, it shows that though NTP service is active, the System clock synchronized is set to no. Meaning the system clock is not synchronized to the npt service. This is required, otherwise you will run into the issue of unsynchronized clocks again after some time. NTP service allows the system clock to synchronize its clocks using a centralized server. The synchronization happens over network and the full form of NTP is Network time protocol. To ensure, your server is communicating with the NTP service, keep the port 123 open in the firewall and allow outbound and inbound traffic through it (this would depend on your firewall configuration).\nTo check the logs of the ntp service, you can run the following command:\njournalctl -u systemd-timesyncd --since \u0026#34;10 minutes ago\u0026#34; ","permalink":"//localhost:1313/posts/ntp/","summary":"\u003cp\u003eFew days back, I encountered the following error on my website \u003ca href=\"https://saral.club\"\u003esaral.club\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebotocore.exceptions.ClientError: An error occurred (SignatureDoesNotMatch) when calling the SendEmail operation:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSignature not yet current: 20250505T152002Z is still later than 20250505T151830Z (20250505T151330Z + 5 min.)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBy the looks of it, the error message is descriptive enough to guide you that there is some kind of time mismatch in the signature. Before sending a request to aws, the botocore library signs the request using your access keys. The signature also includes a timestamp. And the error message is saying that the request I am sending is probably 5 minutes later (in future) then the current time (time on aws servers). Of course, the two clocks (one on my server and the other on aws\u0026rsquo;s server) cannot have the same exact time, so aws allows for some time skew (5 minutes).\u003c/p\u003e","title":"Synchronising Clocks"},{"content":"DRY: Don\u0026rsquo;t Repeat Yourself If you have a section that\u0026rsquo;s being repeated multiple times, you can create an anchor and then reference it. You use \u0026amp;name to create an anchor, and then *name to reference it. One example of it is defining environment variables for different services in docker-compose.yaml.\nenv_vars: \u0026amp;env ENVIRONMENT: production LOGLEVEL: info AWS_REGION_NAME: us-east-1 services: api: environment: *env ... ... backend: ... ... environment: *env Reading environment variables While yaml doesn\u0026rsquo;t read environment variables, but if you pair it with parser, you can read the environment variables. The syntax depends on the parser you are using. The most common places, where I have a need for reading environment variables (or context variables) in yaml file is, cicd pipeline namely github action or circleci and docker-compose.\n# github action uses ${{ }} run: echo running with secrets ${{ secrets.MY_SECRET }} # circleci uses bash style syntax, you have to have these variables in circleci context run: echo running with secrets $MY_SECRET # docker-compose uses interpolation and will read MY_SECRET from your shell or .env file environment: - MY_SECRET=${MY_SECRET} Multiline strings Use \u0026gt; to convert line breaks into spaces. This will fold new lines into a single line until the line ends with a new line description: \u0026gt; This is a long string that I want to break into multiple lines. But this will be second new line. # the above will actually be parsed like this description: | This is a long string that I want to break into multiple lines But this will be second new line. Use | if you want to preserve structure, like line breaks and indentation, useful for writing code blocks. run: | if [[ \u0026#34;$MY_ENV\u0026#34; == \u0026#34;test\u0026#34; ]]; then echo running in test environment fi ","permalink":"//localhost:1313/posts/life-saving-yaml-tricks/","summary":"\u003ch3 id=\"dry-dont-repeat-yourself\"\u003eDRY: Don\u0026rsquo;t Repeat Yourself\u003c/h3\u003e\n\u003cp\u003eIf you have a section that\u0026rsquo;s being repeated multiple times, you can create an anchor and then reference it. You use \u003ccode\u003e\u0026amp;name\u003c/code\u003e to create an anchor, and then \u003ccode\u003e*name\u003c/code\u003e to reference it. One example of it is defining environment variables for different services in \u003ccode\u003edocker-compose.yaml\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eenv_vars\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"cp\"\u003e\u0026amp;env\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eENVIRONMENT\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eproduction\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eLOGLEVEL\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003einfo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eAWS_REGION_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eus-east-1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eservices\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eapi\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eenvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"cp\"\u003e*env\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"l\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"l\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ebackend\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"l\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"l\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eenvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"cp\"\u003e*env\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"reading-environment-variables\"\u003eReading environment variables\u003c/h3\u003e\n\u003cp\u003eWhile yaml doesn\u0026rsquo;t read environment variables, but if you pair it with parser, you can read the environment variables. The syntax depends on the parser you are using. The most common places, where I have a need for reading environment variables (or context variables) in yaml file is, cicd pipeline namely github action or circleci and docker-compose.\u003c/p\u003e","title":"Time Saving Yaml Tricks"},{"content":"Running a Javascript file Suppose you have a javascript file that you want to run from the command line.\nInstall node or deno Run the file with node \u0026lt;filepath.js\u0026gt; or deno \u0026lt;filepath.js\u0026gt; or deno run \u0026lt;filepath.js\u0026gt; Running a TypeScript file Suppose you have a typescript file that you want to run from the command line.\nInstall node. npm comes bundled with node. Install the typescript compiler with npm install -g typescript. Note that this will install the latest version of typescript compiler globally. Compile the file with tsc \u0026lt;filepath.ts\u0026gt; Run the file with node \u0026lt;comiled-filepath.js\u0026gt; Alternatively, you can install the ts-node package with npm install -g ts-node. This will install the latest version of ts-node globally. ts-node compiles the file on the file and executes it. ts-node \u0026lt;filepath.ts\u0026gt; Running a Javascript project The project directory must have a package.json file. This file is used by npm and can also be used to define additional information if you plan to publish the module to npm registry. Install the dependencies mentioned in the package.json file with npm install, more details about package.json The package.json file have a scripts section, this defines the commands that can be run with npm run \u0026lt;command\u0026gt;. In this section, you can define commands like start: node index.js; test: jest ., then if you run npm run test it will run the tests. Note, npm defines three commands which can be run without using the run command, npm start, npm test and npm stop. The start command defaults to using index.js file The package.json file has a main field, this is the file that is executed when you import the package in another file. By default, npm treats the imports as CommonJS modules, if you are using ES modules, you need to add the type key in your package.json with value module. Then all files must use import/export syntax. { name: \u0026#34;my-package\u0026#34;, version: \u0026#34;1.0.0\u0026#34;, main: \u0026#34;index.js\u0026#34;, scripts: { start: \u0026#34;node index.js\u0026#34;, test: \u0026#34;jest .\u0026#34;, }, type: \u0026#34;module\u0026#34;, dependencies: { jest: \u0026#34;^27.5.1\u0026#34;, }, } Running a TypeScript project Using ts-node [!NOTE] You can avoid using ts-node and use tsx which supports TypeScript out of the box. No need to add additional support for esm modules\nIn addition to the steps mentioned above for Javascript, the project directory must also have a tsconfig.json file. This file is used by typescript compiler to compile the files. Note you would still need to install typescript (or ts-node) 2. The tsconfig.json file has a compilerOptions section, this defines the options for the compiler. In this section, you can define the target option, which tells which version of ECMAScript to compile to (use ESNext for latest ECMAScript standard). There are more options available for tsconfig.json, reference { compilerOptions: { target: \u0026#34;ESNext\u0026#34;, // which version of ECMAScript to compile to module: \u0026#34;ESNext\u0026#34;, // which module system to compile to (ECMAScript modules or CommonJS) moduleResolution: \u0026#34;node\u0026#34;, // resolve modules using Node.js style e.g. looking in `node_modules` folder strict: true, // enable strict type checking esModuleInterop: true, // enable interoperability with ES modules and CommonJS modules skipLibCheck: true, // skip type checking of all declaration files (*.d.ts) these files might be used for third party modules types }, include: [\u0026#34;src/**/*.ts\u0026#34;], // which files to include in compilation exclude: [\u0026#34;node_modules\u0026#34;, \u0026#34;dist\u0026#34;], // which files to exclude from compilation outDir: \u0026#34;dist\u0026#34;, // where to place the compiled files // If you are using ECMAScript moduels and ts-node, then add the following \u0026#34;ts-node\u0026#34;: { esm: true, }, } In your package.json file, modify the scripts section to include compilation commands for typescript files. { scripts: { start: \u0026#34;node dist/index.js\u0026#34;, test: \u0026#34;jest .\u0026#34;, build: \u0026#34;tsc\u0026#34;, dev: \u0026#34;ts-node src/index.ts\u0026#34;, // dev: \u0026#34;ts-node --esm src/index.ts\u0026#34; // if you are using ES modules }, } ","permalink":"//localhost:1313/posts/how-to-setup-jsts-project/","summary":"\u003ch2 id=\"running-a-javascript-file\"\u003eRunning a Javascript file\u003c/h2\u003e\n\u003cp\u003eSuppose you have a javascript file that you want to run from the command line.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eInstall \u003ccode\u003enode\u003c/code\u003e or \u003ccode\u003edeno\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eRun the file with \u003ccode\u003enode \u0026lt;filepath.js\u0026gt;\u003c/code\u003e or \u003ccode\u003edeno \u0026lt;filepath.js\u0026gt;\u003c/code\u003e or \u003ccode\u003edeno run \u0026lt;filepath.js\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"running-a-typescript-file\"\u003eRunning a TypeScript file\u003c/h2\u003e\n\u003cp\u003eSuppose you have a typescript file that you want to run from the command line.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eInstall \u003ccode\u003enode\u003c/code\u003e. \u003ccode\u003enpm\u003c/code\u003e comes bundled with \u003ccode\u003enode\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eInstall the typescript compiler with \u003ccode\u003enpm install -g typescript\u003c/code\u003e. Note that this will install the latest version of typescript compiler globally.\u003c/li\u003e\n\u003cli\u003eCompile the file with \u003ccode\u003etsc \u0026lt;filepath.ts\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eRun the file with \u003ccode\u003enode \u0026lt;comiled-filepath.js\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eAlternatively, you can install the \u003ccode\u003ets-node\u003c/code\u003e package with \u003ccode\u003enpm install -g ts-node\u003c/code\u003e. This will install the latest version of \u003ccode\u003ets-node\u003c/code\u003e globally. \u003ccode\u003ets-node\u003c/code\u003e compiles the file on the file and executes it. \u003ccode\u003ets-node \u0026lt;filepath.ts\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"running-a-javascript-project\"\u003eRunning a Javascript project\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eThe project directory must have a \u003ccode\u003epackage.json\u003c/code\u003e file. This file is used by \u003ccode\u003enpm\u003c/code\u003e and can also be used to define additional information if you plan to publish the module to \u003ccode\u003enpm\u003c/code\u003e registry.\u003c/li\u003e\n\u003cli\u003eInstall the dependencies mentioned in the \u003ccode\u003epackage.json\u003c/code\u003e file with \u003ccode\u003enpm install\u003c/code\u003e, \u003ca href=\"https://docs.npmjs.com/cli/v10/configuring-npm/package-json\"\u003emore details about \u003ccode\u003epackage.json\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003epackage.json\u003c/code\u003e file have a \u003ccode\u003escripts\u003c/code\u003e section, this defines the commands that can be run with \u003ccode\u003enpm run \u0026lt;command\u0026gt;\u003c/code\u003e. In this section, you can define commands like \u003ccode\u003estart: node index.js; test: jest .\u003c/code\u003e, then if you run \u003ccode\u003enpm run test\u003c/code\u003e it will run the tests.\u003c/li\u003e\n\u003cli\u003eNote, \u003ccode\u003enpm\u003c/code\u003e defines three commands which can be run without using the \u003ccode\u003erun\u003c/code\u003e command, \u003ccode\u003enpm start\u003c/code\u003e, \u003ccode\u003enpm test\u003c/code\u003e and \u003ccode\u003enpm stop\u003c/code\u003e. The \u003ccode\u003estart\u003c/code\u003e command defaults to using \u003ccode\u003eindex.js\u003c/code\u003e file\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003epackage.json\u003c/code\u003e file has a \u003ccode\u003emain\u003c/code\u003e field, this is the file that is executed when you import the package in another file.\u003c/li\u003e\n\u003cli\u003eBy default, \u003ccode\u003enpm\u003c/code\u003e treats the imports as CommonJS modules, if you are using ES modules, you need to add the \u003ccode\u003etype\u003c/code\u003e key in your \u003ccode\u003epackage.json\u003c/code\u003e with value \u003ccode\u003emodule\u003c/code\u003e. Then all files must use \u003ccode\u003eimport/export\u003c/code\u003e syntax.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  name: \u0026#34;my-package\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  version: \u0026#34;1.0.0\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  main: \u0026#34;index.js\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  scripts: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    start: \u0026#34;node index.js\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    test: \u0026#34;jest .\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  },\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  type: \u0026#34;module\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  dependencies: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    jest: \u0026#34;^27.5.1\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  },\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"running-a-typescript-project\"\u003eRunning a TypeScript project\u003c/h2\u003e\n\u003ch3 id=\"using-ts-node\"\u003eUsing \u003ccode\u003ets-node\u003c/code\u003e\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e[!NOTE]\nYou can avoid using \u003ccode\u003ets-node\u003c/code\u003e and use \u003ccode\u003etsx\u003c/code\u003e which supports TypeScript out of the box. No need to add additional support for esm modules\u003c/p\u003e","title":"How to set up a JavaScript/TypeScript project"},{"content":"I always get confused with, should I run git add ., or should I run git add --all, or should I run git add -A? Given all these commands, do a similar thing, confusion is bound to happen. Thankfully, it\u0026rsquo;s not just me. So I decided to take a deep dive into add command of git, to end this confusion once and for all.\nWhat does add even do? The add command adds your changes to staging area. Staging area is a buffer zone where you place your files before committing them. This buffer zone allows you to be selective with your commits, there are some files that you want to commit now and some files that you want to commit later. Staging area is also known as index.\ngit maintains the index in a file located at .git/index in a binary format. We can use git ls-files --stage command which interprets the binary data of index file and presents it in a human-readable format.\n‚ùØ git ls-files --stage 100644 4d0056ce61ad17b3fec9e285b5c41d5cb405040a 0 .github/workflows/gh-pages.yml 100644 89af1b0cdcdba0b5457d5bb4375ca4ca5f6116f9 0 .gitmodules 100644 e69de29bb2d1d6434b8b29ae775ad8c2e48c5391 0 .hugo_build.lock ... ... ... The first column describes the file \u0026lt;mode\u0026gt;, indicating the type and permission of file. 100644 means a regular non-executable file. Other valid values are: 100755 which means an executable file, 120000 which means a symbolic link. The second column is the SHA-1 hash of the file\u0026rsquo;s content, referencing the corresponding blob object. The third column is \u0026lt;stage\u0026gt; number which is used during merging. The fourth column is the relative path of the file within the repository. When you run git add \u0026lt;filename\u0026gt;, git computes the SHA-1 hash of the file\u0026rsquo;s content, creates a blob object and stores it in .git/objects/. The blob objects are identified by their SHA-1 hash. It then updates the index file by adding or modifying the entry for the file.\nAll the ways to git add Running git add . adds the changes from your current working directory to staging area. Running git add --all adds the changes from the repository to the staging area. This is irrespective of your working directory. Working directory and repository means different things in git. Working directory is where you make changes and repository is where git records the history of those changes. Your project can have multiple directories, and this command will stage changes from all of them. git add -A is same as git add --all. Running git add * can have the same effect as git add .. But note that * is not a git feature but shells\u0026rsquo; feature. The * globbing pattern will match all the files inside the working directory and add them, including even the dot files. You can also add changes interactively, using git add -i. You can also add changes selectively, using git add -p \u0026lt;filename\u0026gt;. This will open an interactive window, allowing you to select which edits within the \u0026lt;filename\u0026gt; you want to stage. How do you undo the add? You can undo the add by running git reset HEAD -- \u0026lt;filename\u0026gt;. By default, the reset command runs with --mixed option, which means it will reset the staging area to match the specified HEAD, but leaves the working directory unchanged.\nRunning git reset will undo git add -A. That is, if you have added all the changes in your repository, running git reset will undo that.\n","permalink":"//localhost:1313/posts/git-add/","summary":"\u003cp\u003eI always get confused with, should I run \u003ccode\u003egit add .\u003c/code\u003e, or should I run \u003ccode\u003egit add --all\u003c/code\u003e, or should I run \u003ccode\u003egit add -A\u003c/code\u003e? Given all these commands, do a similar thing, confusion is bound to happen. Thankfully, it\u0026rsquo;s not just \u003ca href=\"https://stackoverflow.com/questions/23003118/any-difference-between-git-add-and-git-add-all#:~:text=git%20add%20%2D%2Dall%20will,git%20add%20.\"\u003eme\u003c/a\u003e. So I decided to take a deep dive into \u003ccode\u003eadd\u003c/code\u003e command of \u003ccode\u003egit\u003c/code\u003e, to end this confusion once and for all.\u003c/p\u003e\n\u003ch2 id=\"what-does-add-even-do\"\u003eWhat does \u003ccode\u003eadd\u003c/code\u003e even do?\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003eadd\u003c/code\u003e command adds your changes to staging area. Staging area is a buffer zone where you place your files before committing them. This buffer zone allows you to be selective with your commits, there are some files that you want to commit now and some files that you want to commit later. Staging area is also known as \u003ccode\u003eindex\u003c/code\u003e.\u003c/p\u003e","title":"All the ways to `git add`"},{"content":"A practical tutorial on jq So here\u0026rsquo;s the problem statement: Find the repository on github in which you have made most number of commits? And you need to do this on terminal (no python)\nOfcourse, one can use python to find the answer, and it might be probably easy for you, if you have been using python for last many years. But let\u0026rsquo;s see if I can do this in terminal with jq and while doing so, let\u0026rsquo;s learn about it.\nFor installation steps, refer this link\nThe endpoint to get all the repos is: https://api.github.com/users/{username}/repos. Let\u0026rsquo;s try that: curl \u0026#39;https://api.github.com/users/mohit2152sharma/repos\u0026#39; # [{\u0026#34;id\u0026#34;:347381136,\u0026#34;node_id\u0026#34;:\u0026#34;MDEwOlJlcG9zaXRvcnkzNDczODExMzY=\u0026#34;,\u0026#34;name\u0026#34;:\u0026#34;aqad-utilities\u0026#34;,\u0026#34;full_name\u0026#34;:\u0026#34;mohit2152sharma/aqad-utilities\u0026#34;,\u0026#34;private\u0026#34;:false,\u0026#34;owner\u0026#34;:{\u0026#34;login\u0026#34;:\u0026#34;mohit2152sharma\u0026#34;,\u0026#34;id\u0026#34;:26904579,\u0026#34;node_id\u0026#34;:\u0026#34;MDQ6VXNlcjI2OTA0NTc5\u0026#34;,\u0026#34;avatar_url\u0026#34;:\u0026#34;https://avatars.githubusercontent.com/u/26904579?v=4\u0026#34;,\u0026#34;gravatar_id\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;url\u0026#34;:\u0026#34;https://api.github.com/users/mohit2152sharma\u0026#34;,\u0026#34;html_url\u0026#34;:\u0026#34;https://github.com/mohit2152sharma\u0026#34;,\u0026#34;followers_url\u0026#34;:\u0026#34;https://api.github.com/users/mohit2152sharma/followers\u0026#34;,\u0026#34;following_url\u0026#34;:\u0026#34;https://api.github.com/users/mohit2152sharma/following{/other_user}\u0026#34;,\u0026#34;gists_url\u0026#34;:\u0026#34;https://api.github.com/users/mohit2152sharma/gists{/gist_id}\u0026#34;,\u0026#34;starred_url\u0026#34;:\u0026#34;https://api.github.com/users/mohit2152sharma/starred{/owner}{/repo}\u0026#34;, # ... ... If you happen to get an output like above (not pretty), you can easily make it pretty with jq .. The . is also called the identity filter. It takes the input and produces the same value as output. By default it jq pretty prints, so identity filter can be used to pretty print a json output from a command like curl or from a json file (e.g. cat file.json | jq .) curl \u0026#39;https://api.github.com/users/mohit2152sharma/repos\u0026#39; | jq . # [ # { # \u0026#34;id\u0026#34;: 347381136, # \u0026#34;node_id\u0026#34;: \u0026#34;MDEwOlJlcG9zaXRvcnkzNDczODExMzY=\u0026#34;, # \u0026#34;name\u0026#34;: \u0026#34;aqad-utilities\u0026#34;, # ... # ... # ] Let me quickly check what all repositories I have by printing just their name. But let me first check, what all keys are available in the output dictionary. For that, I will use the command jq '.[1] | keys' .[] is the array value iterator, it returns all the values in the array. If you use an integer like .[1] it return the value at index 1. | is a pipe operator. It compbines two filters by taking the output from the filter on left and passing it to the filter on right. keys is a function which returns all the keys of an object (aka dictionary) in an array. There are more builtin functions in jq # output truncated because there are too many keys curl \u0026#39;https://api.github.com/users/mohit2152sharma/repos\u0026#39; | jq \u0026#39;.[1] | keys\u0026#39; # [ # ... # ... # \u0026#34;name\u0026#34;, # \u0026#34;node_id\u0026#34;, # ... # ... # ] The following command .... | jq '.[].name' will return all the names of the repositories. As highlighted above .[] is an array iterator. It iterates over all the values in the array, since each element is an object, I use .name to get the value of key named name. .key_name is an object identifier. When a json object is passed .key_name returns the value at the key \u0026quot;key_name\u0026quot;. You can also do .[\u0026quot;key_name\u0026quot;]. You can also chain the filters .key_name1.key_name2, this is equivalent to .key_name1 | .key_name2. curl \u0026#39;https://api.github.com/users/mohit2152sharma/repos\u0026#39; | jq \u0026#39;.[].name\u0026#39; # \u0026#34;bash-exmpls\u0026#34; # \u0026#34;codesnipper\u0026#34; # \u0026#34;cookiecutter-ml\u0026#34; # \u0026#34;emwv\u0026#34; # ... # ... Let me quickly check, how many public and privte repositories I have. map(f) is a builtin function in jq. It applies the filter f to each element in the array and returns an array. length is also a builtin function, it returns the length (or number of elements) in the array. One can also use it with json objects or string, in those cases, it returns total number of keys and length of string respectively. curl \u0026#39;https://api.github.com/users/mohit2152sharma/repos\u0026#39; | jq \u0026#39;map(select(.visibility==\u0026#34;public\u0026#34;)) | length\u0026#39; # 30 curl \u0026#39;https://api.github.com/users/mohit2152sharma/repos\u0026#39; | jq \u0026#39;map(select(.visibility==\u0026#34;private\u0026#34;)) | length\u0026#39; # 0 # it looks like the response doesn\u0026#39;t include private repos Now let\u0026rsquo;s get back to original question, the repository, in which I have made most number of commits. This more tricky than I expected, because, the url to get the number of commits is different. It is of the form https://api.github.com/users/{user_name}/{repo_name}/commits. So basically, I need to loop through each repo, hit this url, count the number of commits. This became more of bash programming task than that of jq programming task. USER_NAME=mohit2152sharma # get all the repositories getRepoUrl=https://api.github.com/users/${USER_NAME}/repos allRepoNames=\u0026#34;\u0026#34; j=1 while true; do repoInfo=$(curl --url \u0026#34;$getRepoUrl\u0026#34;?page=\u0026#34;$j\u0026#34; --header \u0026#34;Authorization: Bearer $GITHUB_TOKEN\u0026#34;) repoInfoLength=$(echo \u0026#34;$repoInfo\u0026#34; | jq \u0026#39;. | length\u0026#39;) if [ \u0026#34;$repoInfoLength\u0026#34; -eq 0 ]; then # the length of the empty array will be zero break else names=$(echo \u0026#34;$repoInfo\u0026#34; | jq \u0026#39;.[].name\u0026#39;) allRepoNames=\u0026#34;$allRepoNames $names\u0026#34; j=$(( j + 1 )) fi done; # now loop through all repo names and find the commit counts maxCommits=0 repoNameWithMaxCommits=\u0026#34;\u0026#34; for repoName in \u0026#34;$allRepoNames\u0026#34;; do i=1 totalCommits=0 getCommitUrl=https://api.github.com/repos/${USER_NAME}/${repoName}/commits while true; do ncommits=$(curl --url \u0026#34;$getCommitUrl\u0026#34;?page=\u0026#34;$i\u0026#34; --header \u0026#34;Authorization: Bearer $GITHUB_TOKEN\u0026#34; | jq \u0026#39;map(select(.author.login==\u0026#34;mohit2152sharma\u0026#34;)) | length\u0026#39;) if [ \u0026#34;$ncommits\u0026#34; -eq 0 ]; then break else totalCommits=$(( totalCommits + ncommits )) i=$(( i + 1 )) fi done if [ \u0026#34;$totalCommits\u0026#34; -gt \u0026#34;$maxCommits\u0026#34; ]; then maxCommits=$totalCommits repoNameWithMaxCommits=$repoName fi done echo \u0026#34;Repository with most number of commits: ${repoNameWithMaxCommits} with ${maxCommits} commits\u0026#34; The above script prints the following output: # Repository with most number of commits: rcoronavirus with 192 commits ","permalink":"//localhost:1313/posts/jq/","summary":"\u003ch2 id=\"a-practical-tutorial-on-jq\"\u003eA practical tutorial on \u003ccode\u003ejq\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSo here\u0026rsquo;s the problem statement: \u003cem\u003e\u003cstrong\u003eFind the repository on github in which you have made most number of commits? And you need to do this on terminal (no python)\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eOfcourse, one can use python to find the answer, and it might be probably easy for you, if you have been using python for last many years. But let\u0026rsquo;s see if I can do this in terminal with \u003ccode\u003ejq\u003c/code\u003e and while doing so, let\u0026rsquo;s learn about it.\u003c/p\u003e","title":"How to parse json in terminal using jq"},{"content":"Manager: Hey, I need your help, I have couple of images that are taking a lot of space on my PC, I want to delete them. How can I do that?\nDeveloper: Well that should be simple. Here, you go. This looks for all files with .png extension in the current directory and its subdirectories (using -R flag), then pipes those file names to rm command to delete them.\nls -R | grep \u0026#34;.png$\u0026#34; | xargs rm Manager: Nice, but wait. This will delete all the png files in the current directory and its subdirectories. I only want to delete in specific directories.\nDeveloper: Okay, that should be easy as well.\nls -R dir1 dir2 | grep \u0026#34;.png$\u0026#34; | xargs rm Manager: This only selects .png but I also have image of .jpg and .jpeg files. I want to delete them too.\nDeveloper: Okaay, this getting complicated a little bit. I think I can do that with find command, think that is much safer.\n# command 1 # {} is a placeholder for matched file # {} \\; means execute rm command for each matched file # the -o flag means OR operator and \\( means brackets are escaped # and used to club together the expression using or operator find dir1 dir2 -type f \\( -name \u0026#34;*.png\u0026#34; -o -name \u0026#34;*.jpg\u0026#34; -o -name \u0026#34;*.jpeg\u0026#34; \\) -exec rm {} \\; # command 2 # -E enables extended regex # rm {} + means rm file1 file2 file3 .... find -E dir1 dir2 -type f -regex \u0026#34;.*/.*(png|jpg|jpeg)\u0026#34; -exec rm {} + Manager: Much better, now narrow down the files to only those files which were created in last 7 days.\nDeveloper: Okay, is that it? Or are there any more conditions?\nManager: Yeah, and one more condition, files should be at least 5 MB in size.\nDeveloper: I see, is that it?\nManager: Yeah, think so. Can you do that?\nDeveloper: Sure. This should do the trick.\nfind -E dir1 dir2 -type f -regex \u0026#34;.*/.*(png|jpg|jpeg)\u0026#34; -ctime -7 -size +5M -exec rm {} + Developer: To explain in more detail, find command is of the form: find [flags] [path(s) to search in] [expression(s) or filter(s)] [actions].\n","permalink":"//localhost:1313/posts/find/","summary":"\u003cp\u003e\u003cem\u003e\u003cstrong\u003eManager\u003c/strong\u003e\u003c/em\u003e: Hey, I need your help, I have couple of images that are taking a lot of space on my PC, I want to delete them. How can I do that?\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eDeveloper\u003c/strong\u003e\u003c/em\u003e: Well that should be simple. Here, you go. This looks for all files with \u003ccode\u003e.png\u003c/code\u003e extension in the current directory and its subdirectories (using \u003ccode\u003e-R\u003c/code\u003e flag), then pipes those file names to \u003ccode\u003erm\u003c/code\u003e command to delete them.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -R \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep \u003cspan class=\"s2\"\u003e\u0026#34;.png\u003c/span\u003e$\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e xargs rm\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cem\u003e\u003cstrong\u003eManager\u003c/strong\u003e\u003c/em\u003e: Nice, but wait. This will delete all the \u003ccode\u003epng\u003c/code\u003e files in the current directory and its subdirectories. I only want to delete in specific directories.\u003c/p\u003e","title":"How to `find` files in terminal?"},{"content":"First Post This is an example post to test the website. It just contains some rough snippets.\ndef hello_world(): print(\u0026#34;Hello, World!\u0026#34;) ","permalink":"//localhost:1313/posts/first-post/","summary":"\u003ch1 id=\"first-post\"\u003eFirst Post\u003c/h1\u003e\n\u003cp\u003eThis is an example post to test the website. It just contains some rough snippets.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehello_world\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Hello, World!\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"First Post"}]